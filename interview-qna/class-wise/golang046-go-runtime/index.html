<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Golang046 Go Runtime - BGCE ARCHIVE</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">BGCE ARCHIVE</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/NesoHQ/bgce-archive.git" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="class-46---go-runtime"><a class="header" href="#class-46---go-runtime">Class 46 : üêπ Go Runtime</a></h1>
<h2 id="-guide-to-ram-kernel-space-vs-user-space"><a class="header" href="#-guide-to-ram-kernel-space-vs-user-space">üß† Guide to RAM: Kernel Space vs User Space</a></h2>
<p>‡¶ï‡¶Æ‡ßç‡¶™‡¶ø‡¶â‡¶ü‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡¶≤‡ßá RAM (Random Access Memory) ‡¶ï‡ßá ‡¶¶‡ßÅ‡¶á‡¶ü‡¶æ ‡¶≠‡¶æ‡¶ó‡ßá ‡¶≠‡¶æ‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º:</p>
<ul>
<li>üõ°Ô∏è <strong>Kernel Space</strong></li>
<li>üë®‚Äçüíª <strong>User Space</strong></li>
</ul>
<h2 id="-kernel-space"><a class="header" href="#-kernel-space">üõ°Ô∏è Kernel Space:</a></h2>
<p>‡¶è‡¶ü‡¶æ Operating System (OS) ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø allocated space</p>
<p>‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶•‡¶æ‡¶ï‡ßá:</p>
<ul>
<li>OS ‡¶è‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶ï‡ßã‡¶° (kernel code)</li>
<li>kernel data structures</li>
<li>page table (memory mapping ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)</li>
</ul>
<blockquote>
<p>Kernel ‡¶∏‡¶¨ ‡¶ï‡¶ø‡¶õ‡ßÅ access ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§</p>
</blockquote>
<h3 id="-why-its-protected"><a class="header" href="#-why-its-protected">üîê Why it's protected?</a></h3>
<ul>
<li>‡¶Ø‡¶æ‡¶§‡ßá user program ‡¶ó‡ßÅ‡¶≤‡ßã kernel ‡¶è‡¶∞ sensitive ‡¶Ö‡¶Ç‡¶∂‡ßá ‡¶≠‡ßÅ‡¶≤ ‡¶ï‡¶∞‡ßá ‡¶¨‡¶æ ‡¶á‡¶ö‡ßç‡¶õ‡¶æ ‡¶ï‡¶∞‡ßá access ‡¶ï‡¶∞‡¶§‡ßá ‡¶®‡¶æ ‡¶™‡¶æ‡¶∞‡ßá‡•§</li>
<li>Security ‡¶Ü‡¶∞ stability ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</li>
</ul>
<h3 id="-access-from-user-programs"><a class="header" href="#-access-from-user-programs">üß© Access from user programs</a></h3>
<ul>
<li>User program ‡¶Ø‡¶¶‡¶ø OS ‡¶è‡¶∞ help ‡¶ö‡¶æ‡ßü, ‡¶§‡¶ñ‡¶® system call ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá (‡¶Ø‡ßá‡¶Æ‡¶® <code>read()</code>, <code>write()</code>, <code>open()</code>).</li>
<li>‡¶§‡¶ñ‡¶® ‡¶è‡¶ï‡¶ü‡¶æ software interrupt (‡¶Ø‡ßá‡¶Æ‡¶® <code>0x80</code>) ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡•§</li>
<li>‡¶è‡¶§‡ßá CPU <em>user mode</em> ‡¶•‡ßá‡¶ï‡ßá <em>kernel mode</em> ‡¶è ‡¶Ø‡¶æ‡ßü, kernel ‡¶ï‡¶æ‡¶ú‡¶ü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡ßü‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ü‡¶∏‡ßá‡•§</li>
</ul>
<h3 id="-kernel-stack"><a class="header" href="#-kernel-stack">üßµ Kernel Stack</a></h3>
<ul>
<li>‡¶Ø‡¶ñ‡¶® kernel ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá, ‡¶§‡¶ñ‡¶® ‡¶è‡¶ï‡¶ü‡¶æ kernel stack ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶ü‡¶æ ‡¶∏‡¶¨ process ‡¶Æ‡¶ø‡¶≤‡ßá share ‡¶ï‡¶∞‡ßá‡•§</li>
</ul>
<h2 id="-user-space"><a class="header" href="#-user-space">üë®‚Äçüíª User Space:</a></h2>
<p>RAM ‡¶è‡¶∞ ‡¶è‡¶á space ‚Üí user application (‡¶Ø‡ßá‡¶Æ‡¶® browser, notepad) ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</p>
<p>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ process ‡¶§‡¶æ‡¶∞ ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶æ <em>virtual memory</em> ‡¶™‡¶æ‡ßü‡•§</p>
<p>‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶•‡¶æ‡¶ï‡ßá:</p>
<ul>
<li><strong>Code:</strong> ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ instruction</li>
<li><strong>Data:</strong> global ‡¶¨‡¶æ static variables</li>
<li><strong>Heap:</strong> dynamic memory allocation (‡¶Ø‡ßá‡¶Æ‡¶® <code>malloc</code>)</li>
<li><strong>Stack:</strong> function call ‡¶Ü‡¶∞ local variables</li>
</ul>
<blockquote>
<p>‚ö†Ô∏è ‡¶è‡¶á space ‡¶•‡ßá‡¶ï‡ßá kernel space ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø access ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü ‡¶®‡¶æ‡•§</p>
</blockquote>
<h2 id="-system-call"><a class="header" href="#-system-call">üß© System Call</a></h2>
<ul>
<li>System Call ‡¶π‡¶≤‡ßã ‡¶è‡¶ï‡¶ß‡¶∞‡¶®‡ßá‡¶∞ function call</li>
<li>‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶ï‡ßã‡¶® user program, Operating System ‡¶è‡¶∞ kernel ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡ßã‡¶® service ‡¶ö‡¶æ‡ßü</li>
<li>System Call ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø user mode ‡¶•‡ßá‡¶ï‡ßá kernel mode ‡¶è ‡¶∏‡ßÅ‡¶á‡¶ö ‡¶ï‡¶∞‡ßá OS ‡¶è‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡¶æ‡¶ú‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡¶§‡¶ø ‡¶¶‡ßá‡¶Ø‡¶º</li>
</ul>
<h3 id="-user-mode-vs-kernel-mode"><a class="header" href="#-user-mode-vs-kernel-mode">‚öôÔ∏è User Mode vs Kernel Mode</a></h3>
<ul>
<li>‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶≠‡¶æ‡¶¨‡ßá program ‡¶ö‡¶≤‡ßá user mode ‡¶è, ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá resource access ‡¶∏‡ßÄ‡¶Æ‡¶ø‡¶§ ‡¶•‡¶æ‡¶ï‡ßá‡•§</li>
<li>‡¶ï‡ßã‡¶® special ‡¶ï‡¶æ‡¶ú (‡¶Ø‡ßá‡¶Æ‡¶® file read/write, process ‡¶§‡ßà‡¶∞‡¶ø) ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶≤‡ßá system call ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡ßü, ‡¶§‡¶ñ‡¶® program kernel mode ‡¶è ‡¶Ø‡¶æ‡ßü‡•§</li>
</ul>
<h2 id="-intro-to-go-runtime"><a class="header" href="#-intro-to-go-runtime">‚ú® Intro to Go Runtime</a></h2>
<pre><code class="language-bash">go build main.go
</code></pre>
<p>Go compiler:</p>
<ul>
<li>main.go ‡¶´‡¶æ‡¶á‡¶≤‡¶ü‡¶æ compile ‡¶ï‡¶∞‡ßá</li>
<li>‡¶§‡¶æ‡¶∞‡¶™‡¶∞ ‡¶è‡¶ï‡¶ü‡¶æ binary executable file ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá - ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶ü‡¶æ ‡¶π‡ßü <code>main</code> ‡¶®‡¶æ‡¶Æ‡ßá (Linux/Unix-‡¶è)</li>
</ul>
<pre><code class="language-bash">./main
</code></pre>
<p>‡¶è‡¶ï‡¶ü‡¶æ process create ‡¶π‡ßü</p>
<p><strong>üîÅ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡ßá‡¶™‡ßá flow:</strong></p>
<pre><code class="language-plaintext">go build main.go   ‚Üí  main (binary file)
./main             ‚Üí  OS creates a process
                   ‚Üí  program runs
</code></pre>
<h3 id="-main-stack-‡¶è‡¶¨‡¶Ç-stack-frame"><a class="header" href="#-main-stack-‡¶è‡¶¨‡¶Ç-stack-frame">üì¶ Main Stack ‡¶è‡¶¨‡¶Ç Stack Frame</a></h3>
<ul>
<li>Main thread ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø stack ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü - ‡¶è‡¶ü‡¶æ‡¶ï‡ßá ‡¶¨‡¶≤‡ßá main stack‡•§</li>
<li>Go runtime ‡¶è‡¶∞ function ‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶á main stack ‡¶è stack frames ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü‡•§</li>
<li>Main thread ‚Üí execute ‚Üí go runtime stack</li>
</ul>
<p><strong>üîπ Stack Frame:</strong>
‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ function call ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶æ stack frame ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü‡•§</p>
<p>Stack frame ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶•‡¶æ‡¶ï‡ßá:</p>
<ul>
<li>function ‡¶è‡¶∞ local variables,</li>
<li>return address (function ‡¶∂‡ßá‡¶∑‡ßá ‡¶ï‡ßã‡¶•‡¶æ‡ßü ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá),</li>
<li>‡¶ï‡¶ø‡¶õ‡ßÅ runtime bookkeeping data‡•§</li>
</ul>
<p><strong>üîπGo Runtime -</strong></p>
<ul>
<li>Memory allocate</li>
<li>Set up ‚Üí Stack &amp; Heap</li>
<li>Initialize ‚Üí Go Scheduler</li>
<li>Go Runtime ‚Üí System Call ‚Üí Kernel ‚Üí <code>epoll_create</code></li>
</ul>
<h3 id="-what-is-epoll-in-linux"><a class="header" href="#-what-is-epoll-in-linux">üåÄ What is epoll in Linux?</a></h3>
<ul>
<li><code>epoll</code> ‡¶π‡¶≤‡ßã Linux kernel ‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø I/O <em>event notification system</em></li>
<li>‡¶è‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶Ö‡¶®‡ßá‡¶ï‡¶ó‡ßÅ‡¶≤‡ßã <em>file descriptor (fd)</em> ‡¶è‡¶∞ ‡¶ì‡¶™‡¶∞ efficiently ‡¶®‡¶ú‡¶∞ ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</li>
</ul>
<blockquote>
<p>‡¶è‡¶ü‡¶ø <code>select()</code> ‡¶¨‡¶æ <code>poll()</code> ‡¶è‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶∞‡¶ì scalable, efficient, ‡¶è‡¶¨‡¶Ç faster‡•§</p>
</blockquote>
<p>Linux-‡¶è‡¶∞ epoll ‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã high-performance I/O event notification mechanisms ‡¶Ö‡¶®‡ßç‡¶Ø OS-‡¶ó‡ßÅ‡¶≤‡ßã‡¶§‡ßá‡¶ì ‡¶Ü‡¶õ‡ßá</p>
<h4 id="-macos-darwinbsd--kqueue"><a class="header" href="#-macos-darwinbsd--kqueue">üñ•Ô∏è MacOS (Darwin/BSD) ‚û§ kqueue</a></h4>
<ul>
<li>Equivalent of epoll in macOS is kqueue.</li>
<li>‡¶è‡¶ü‡¶ø BSD-based systems (macOS, FreeBSD, OpenBSD) ‡¶è ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡ßü‡•§</li>
</ul>
<h4 id="-windows--iocp-io-completion-ports"><a class="header" href="#-windows--iocp-io-completion-ports">ü™ü Windows ‚û§ IOCP (I/O Completion Ports)</a></h4>
<ul>
<li>Windows-‡¶è‡¶∞ equivalent ‡¶π‡¶≤ ‚û§ IOCP (I/O Completion Ports)‡•§</li>
</ul>
<p><strong>üîπ IOCP-‡¶è‡¶∞ ‡¶ï‡¶æ‡¶ú:</strong></p>
<ul>
<li>Asynchronous I/O operations handle ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡ßü‡•§</li>
<li>Efficient ‡¶è‡¶¨‡¶Ç scalable, especially high-performance servers-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</li>
</ul>
<h3 id="-epoll-‡¶ï‡¶¨‡ßá-‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞-‡¶π‡ßü"><a class="header" href="#-epoll-‡¶ï‡¶¨‡ßá-‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞-‡¶π‡ßü">üß† epoll ‡¶ï‡¶¨‡ßá ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶π‡ßü?</a></h3>
<ul>
<li>Network socket</li>
<li>File</li>
<li>Pipe</li>
</ul>
<p>‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá monitor ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶¨‡¶Ç ‡¶ï‡ßã‡¶®‡¶ü‡¶æ read/write ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ready ‡¶π‡ßü‡ßá‡¶õ‡ßá</p>
<pre><code class="language-plaintext">epfd = epoll_create1(0);                // epoll instance ‡¶§‡ßà‡¶∞‡¶ø
epoll_ctl(epfd, ADD, sockfd, &amp;event);   // ‡¶ï‡ßã‡¶® socket watch ‡¶ï‡¶∞‡¶¨‡ßã?
epoll_wait(epfd, events, MAX, timeout); // wait ‡¶ï‡¶∞‡¶¨‡ßã ‡¶ï‡¶ñ‡¶® data ‡¶Ü‡¶∏‡¶¨‡ßá
</code></pre>
<h3 id="-epoll-‡¶è‡¶∞-‡¶ú‡¶®‡¶Ø-‡¶¨‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§-‡ß©‡¶ü‡¶ø-main-syscall"><a class="header" href="#-epoll-‡¶è‡¶∞-‡¶ú‡¶®‡¶Ø-‡¶¨‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§-‡ß©‡¶ü‡¶ø-main-syscall">üîß epoll ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡ß©‡¶ü‡¶ø main syscall</a></h3>
<p><strong><code>epoll_create</code> / <code>epoll_create1</code></strong></p>
<ul>
<li>‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® epoll instance ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç ‡¶è‡¶ï‡¶ü‡¶ø file descriptor (fd) ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶á fd ‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ‡¶§‡ßá ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü monitor ‡¶ï‡¶∞‡¶¨‡ßá‡¶®‡•§</li>
</ul>
<p><strong><code>epoll_ctl</code></strong></p>
<ul>
<li>epoll instance ‡¶è ‡¶ï‡ßã‡¶® file descriptor monitor ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá ‡¶∏‡ßá‡¶ü‡¶æ ‡¶¨‡¶≤‡ßá ‡¶¶‡ßá‡ßü‡•§</li>
<li>‡¶Ö‡¶∞‡ßç‡¶•‡¶æ‡ßé: add / modify / delete operation‡•§</li>
</ul>
<p><strong><code>epoll_wait</code></strong></p>
<ul>
<li>‡¶è‡¶ü‡¶ø block ‡¶ï‡¶∞‡ßá (‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßá) ‡¶Ø‡¶§‡¶ï‡ßç‡¶∑‡¶£ ‡¶®‡¶æ ‡¶ï‡ßã‡¶® monitored file descriptor ‡¶•‡ßá‡¶ï‡ßá I/O event ‡¶Ü‡¶∏‡ßá‡•§</li>
<li>‡¶Ø‡¶ñ‡¶® ‡¶Ü‡¶∏‡ßá, ‡¶§‡¶ñ‡¶® ‡¶∏‡ßá‡¶á event return ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡ßü‡•§</li>
</ul>
<h3 id="-scenario-epoll-based-non-blocking-file-read-in-linux"><a class="header" href="#-scenario-epoll-based-non-blocking-file-read-in-linux">üè∑Ô∏è Scenario: epoll-based Non-blocking File Read in Linux</a></h3>
<p><strong>Process &amp; Threads</strong></p>
<ul>
<li>P1: T1, T2</li>
<li>P2: T1</li>
<li>P3: T1, T2, T3</li>
</ul>
<p>P1-T1 ‡¶è‡¶ï‡¶ü‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡ßú‡¶§‡ßá ‡¶ö‡¶æ‡ßü, ‡¶Ö‡¶∞‡ßç‡¶•‡¶æ‡ßé I/O operation ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡ßü‡•§</p>
<p>‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ß‡¶∞‡¶õ‡¶ø ‡¶è‡¶ü‡¶æ non-blocking I/O ‡¶è‡¶¨‡¶Ç epoll ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶ö‡ßç‡¶õ‡ßá (Linux system)‡•§</p>
<h4 id="‡ßß-t1-‡¶´‡¶æ‡¶á‡¶≤-‡¶™‡ßú‡¶§‡ßá-‡¶ö‡¶æ‡ßü"><a class="header" href="#‡ßß-t1-‡¶´‡¶æ‡¶á‡¶≤-‡¶™‡ßú‡¶§‡ßá-‡¶ö‡¶æ‡ßü">‡ßßÔ∏è‚É£ T1 ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡ßú‡¶§‡ßá ‡¶ö‡¶æ‡ßü</a></h4>
<ul>
<li>T1 kernel-‡¶è read request ‡¶™‡¶æ‡¶†‡¶æ‡ßü, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶§‡¶ñ‡¶®‡¶ì ‡¶∞‡ßá‡¶°‡¶ø ‡¶®‡¶æ‡•§</li>
<li>‡¶§‡¶æ‡¶á T1 ‡¶¨‡¶≤‡ßá, "‡¶´‡¶æ‡¶á‡¶≤ ‡¶∞‡ßá‡¶°‡¶ø ‡¶π‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶ø‡¶ì" ‚Äî non-blocking mode</li>
</ul>
<h4 id="2-t1-syscall-‡¶ï‡¶∞‡ßá--epoll_ctl"><a class="header" href="#2-t1-syscall-‡¶ï‡¶∞‡ßá--epoll_ctl">2Ô∏è‚É£ T1 syscall ‡¶ï‡¶∞‡ßá ‚Üí epoll_ctl</a></h4>
<ul>
<li>‡¶è‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá kernel-‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶æ‡¶®‡ßã ‡¶π‡ßü:</li>
<li>"‡¶è‡¶á ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶¨‡ßã‡•§ ‡¶´‡¶æ‡¶á‡¶≤‡¶ü‡¶æ read ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶≤‡ßá‡¶á ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶°‡¶æ‡¶ï‡ßã‡•§"</li>
</ul>
<h4 id="3-kernel-t1-‡¶ï‡ßá-‡¶ò‡ßÅ‡¶Æ-‡¶™‡¶æ‡ßú‡¶ø‡ßü‡ßá-‡¶¶‡ßá‡ßü"><a class="header" href="#3-kernel-t1-‡¶ï‡ßá-‡¶ò‡ßÅ‡¶Æ-‡¶™‡¶æ‡ßú‡¶ø‡ßü‡ßá-‡¶¶‡ßá‡ßü">3Ô∏è‚É£ Kernel T1 ‡¶ï‡ßá ‡¶ò‡ßÅ‡¶Æ ‡¶™‡¶æ‡ßú‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡ßü</a></h4>
<ul>
<li>‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶è‡¶ñ‡¶®‡ßã ‡¶∞‡ßá‡¶°‡¶ø ‡¶®‡¶æ, ‡¶§‡¶æ‡¶á kernel T1 ‡¶ï‡ßá sleep/wait ‡¶ï‡¶∞‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡ßü‡•§</li>
<li>T1 wait queue ‡¶§‡ßá ‡¶ö‡¶≤‡ßá ‡¶Ø‡¶æ‡ßü</li>
<li>‡¶§‡¶ñ‡¶® P1-‡¶è‡¶∞ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶•‡ßç‡¶∞‡ßá‡¶° T2, ‡¶¨‡¶æ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡ßá‡¶∞ ‡¶•‡ßç‡¶∞‡ßá‡¶°‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∏‡ßç‡¶¨‡¶æ‡¶≠‡¶æ‡¶¨‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá</li>
</ul>
<h4 id="4-kernel-‡¶´‡¶æ‡¶á‡¶≤-‡¶ö‡ßá‡¶ï-‡¶ï‡¶∞‡¶§‡ßá-‡¶•‡¶æ‡¶ï‡ßá"><a class="header" href="#4-kernel-‡¶´‡¶æ‡¶á‡¶≤-‡¶ö‡ßá‡¶ï-‡¶ï‡¶∞‡¶§‡ßá-‡¶•‡¶æ‡¶ï‡ßá">4Ô∏è‚É£ kernel ‡¶´‡¶æ‡¶á‡¶≤ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡ßá</a></h4>
<ul>
<li>kernel backend-‡¶è ‡¶´‡¶æ‡¶á‡¶≤ ready ‡¶ï‡¶ø‡¶®‡¶æ ‡¶∏‡ßá‡¶ü‡¶æ monitor ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶Ø‡¶ñ‡¶® ‡¶´‡¶æ‡¶á‡¶≤‡¶ü‡¶æ readable ‡¶π‡ßü‡ßá ‡¶Ø‡¶æ‡ßü, ‡¶§‡¶ñ‡¶® kernel ‡¶´‡¶æ‡¶á‡¶≤‡¶ü‡¶æ load ‡¶ï‡¶∞‡ßá, ‡¶è‡¶¨‡¶Ç ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø file descriptor ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá</li>
</ul>
<h4 id="5-kernel-epoll-‡¶ï‡ßá-notify-‡¶ï‡¶∞‡ßá"><a class="header" href="#5-kernel-epoll-‡¶ï‡ßá-notify-‡¶ï‡¶∞‡ßá">5Ô∏è‚É£ kernel epoll ‡¶ï‡ßá notify ‡¶ï‡¶∞‡ßá</a></h4>
<ul>
<li>kernel epoll_wait ‡¶ï‡ßá ‡¶¨‡¶≤‡ßá: "‡¶è‡¶á file descriptor ‡¶è‡¶ñ‡¶® ready"</li>
<li>epoll_wait ‡¶§‡¶ñ‡¶® ‡¶∏‡ßá‡¶á FD ‡¶ï‡ßá ready list-‡¶è ‡¶∞‡¶æ‡¶ñ‡ßá</li>
</ul>
<h4 id="6-epoll_wait-thread-‡¶ï‡ßá-‡¶ú‡¶æ‡¶ó‡¶ø‡ßü‡ßá-‡¶§‡ßã‡¶≤‡ßá"><a class="header" href="#6-epoll_wait-thread-‡¶ï‡ßá-‡¶ú‡¶æ‡¶ó‡¶ø‡ßü‡ßá-‡¶§‡ßã‡¶≤‡ßá">6Ô∏è‚É£ epoll_wait Thread ‡¶ï‡ßá ‡¶ú‡¶æ‡¶ó‡¶ø‡ßü‡ßá ‡¶§‡ßã‡¶≤‡ßá</a></h4>
<p><em>epoll_wait ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶ú:</em></p>
<ul>
<li>‡¶Ø‡¶æ‡¶∞‡¶æ ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶õ‡¶ø‡¶≤, ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ú‡¶æ‡¶®‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡ßü‡¶æ "‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∞‡ßá‡¶°‡¶ø"</li>
<li>T1 ‡¶è‡¶ñ‡¶® wake up ‡¶π‡ßü</li>
</ul>
<h4 id="7-t1-‡¶è‡¶ñ‡¶®-readfd-‡¶¶‡¶ø‡ßü‡ßá-‡¶´‡¶æ‡¶á‡¶≤-‡¶™‡ßú‡ßá"><a class="header" href="#7-t1-‡¶è‡¶ñ‡¶®-readfd-‡¶¶‡¶ø‡ßü‡ßá-‡¶´‡¶æ‡¶á‡¶≤-‡¶™‡ßú‡ßá">7Ô∏è‚É£ T1 ‡¶è‡¶ñ‡¶® read(fd) ‡¶¶‡¶ø‡ßü‡ßá ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡ßú‡ßá</a></h4>
<ul>
<li>‡¶è‡¶¨‡¶æ‡¶∞ T1 ‡¶´‡¶æ‡¶á‡¶≤‡¶ü‡¶ø read ‡¶ï‡¶∞‡ßá ‡¶®‡ßá‡ßü file descriptor ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá</li>
<li>File descriptor ‡¶è‡¶ï‡¶ü‡¶ø token ‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá ‚Äî ‡¶è‡¶ü‡¶ø ‡¶¨‡¶≤‡ßá ‡¶¶‡ßá‡ßü kernel-‡¶è‡¶∞ ‡¶ï‡ßã‡¶® ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡ßú‡¶§‡ßá ‡¶π‡¶¨‡ßá</li>
</ul>
<h3 id="-file-descriptor"><a class="header" href="#-file-descriptor">üì¶ File descriptor</a></h3>
<ul>
<li>File descriptor ‡¶π‡¶ö‡ßç‡¶õ‡ßá kernel-‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø token ‡¶¨‡¶æ ID ‡¶Ø‡¶æ file/socket-‡¶è‡¶∞ represent ‡¶ï‡¶∞‡ßá‡•§</li>
<li>User-space access ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶®‡¶æ, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ kernel ‡¶Ü‡¶∞ Go runtime, file/socket ‡¶ï‡ßá ‡¶ö‡¶ø‡¶®‡ßá ‡¶´‡ßá‡¶≤‡ßá ‡¶è‡¶á FD ‡¶¶‡¶ø‡ßü‡ßá‡•§</li>
</ul>
<h3 id="-back-to-go-runtime-story"><a class="header" href="#-back-to-go-runtime-story">üöÄ Back to Go Runtime Story</a></h3>
<p><strong>1. Go Runtime ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá‡¶á ‡¶ï‡ßÄ ‡¶ï‡¶∞‡ßá?</strong></p>
<ul>
<li>Go runtime ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶ï‡¶ü‡¶æ epoll instance ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá (epoll_create syscall ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá)‡•§</li>
<li>‡¶Ø‡¶ñ‡¶® epoll ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá, ‡¶§‡¶ñ‡¶® kernel-‡¶ï‡ßá ‡¶¨‡¶≤‡ßá ‡¶¶‡ßá‡ßü ‡¶ï‡¶§‡¶ó‡ßÅ‡¶≤‡ßã file descriptor (FD) ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶™‡ßú‡¶§‡ßá ‡¶ö‡¶æ‡ßü
<ul>
<li>Go Runtime kernel-‡¶ï‡ßá ‡¶¨‡¶≤‡ßá ‡¶¶‡ßá‡ßü 100 file descriptor (FD) ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶™‡ßú‡¶§‡ßá ‡¶ö‡¶æ‡ßü</li>
<li>Max 100 FD read ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø <code>epoll_ctl</code> send ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá kernel ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá</li>
<li>100 FD list ‡¶Ü‡¶ï‡¶æ‡¶∞‡ßá epoll_wait thread ‡¶ï‡ßá ‡¶¶‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶¨‡ßá</li>
<li><code>epoll_wait</code> thread FD list Go runtime ‡¶ï‡ßá ‡¶¶‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶¨‡ßá</li>
</ul>
</li>
<li>‡¶è‡¶á instance handle ‡¶ï‡¶∞‡ßá ‡¶∏‡¶¨ network I/O ‡¶¨‡¶æ file I/O ‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶∂‡¶®‡•§</li>
<li>‡¶è‡¶∞‡¶™‡¶∞ Go runtime ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ OS thread ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá <code>epoll_wait</code> ‡¶¨‡¶∏‡ßá ‡¶•‡¶æ‡¶ï‡ßá‡•§ ‡¶è‡¶á ‡¶•‡ßç‡¶∞‡ßá‡¶°‡¶ï‡ßá ‡¶¨‡¶≤‡¶æ ‡¶Ø‡¶æ‡ßü "Netpoller Thread"‡•§</li>
</ul>
<p><strong>2. ‡¶è‡¶ï‡¶ü‡¶ø goroutine file/socket read ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡ßü</strong></p>
<ul>
<li>main goroutine (‡¶Ø‡ßá‡¶Æ‡¶® <code>go func() { conn.Read() }</code>) socket ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶™‡ßú‡¶§‡ßá ‡¶ö‡¶æ‡ßü‡•§</li>
<li>‡¶Ø‡¶¶‡¶ø data ‡¶§‡¶ñ‡¶®‡¶á available ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, Go runtime:
<ul>
<li>‡¶ì‡¶á goroutine ‡¶ï‡ßá block ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá park (‡¶ò‡ßÅ‡¶Æ ‡¶™‡¶æ‡ßú‡¶ø‡ßü‡ßá) ‡¶¶‡ßá‡ßü‡•§</li>
<li>‡¶è‡¶ï‡¶á‡¶∏‡¶æ‡¶•‡ßá, ‡¶∏‡ßá‡¶á socket ‡¶¨‡¶æ file descriptor ‡¶ï‡ßá epoll instance-‡¶è register ‡¶ï‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡ßá (<code>epoll_ctl</code> ‡¶¶‡¶ø‡ßü‡ßá)‡•§</li>
</ul>
</li>
</ul>
<p><strong>3. epoll_wait ‡¶ï‡ßÄ ‡¶ï‡¶∞‡ßá?</strong></p>
<ul>
<li>‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ Netpoller Thread ‡¶∏‡¶¨‡¶∏‡¶Æ‡ßü epoll_wait syscall ‡¶ö‡¶æ‡¶≤‡¶ø‡ßü‡ßá ‡¶ò‡ßÅ‡¶Æ‡¶ø‡ßü‡ßá ‡¶•‡¶æ‡¶ï‡ßá‡•§</li>
<li>‡¶Ø‡¶ñ‡¶® kernel detect ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßá socket/data ready, ‡¶§‡¶ñ‡¶® ‡¶∏‡ßá‡¶á Netpoller Thread ‡¶ï‡ßá wake ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡ßü‡ßá data ‡¶¶‡ßá‡ßü‡•§</li>
<li>‡¶è‡¶∞‡¶™‡¶∞ Netpoller ‡¶ú‡¶æ‡¶®‡¶æ‡ßü ‡¶Ø‡ßá fd ready‡•§</li>
</ul>
<p><strong>4. Go Runtime ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡ßü goroutine ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßá</strong></p>
<ul>
<li>Go runtime ‡¶¨‡ßÅ‡¶ù‡ßá ‡¶Ø‡¶æ‡ßü ‡¶Ø‡ßá ‡¶Ø‡ßá goroutine file/socket read ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡ßá‡ßü‡ßá‡¶õ‡¶ø‡¶≤ ‡¶§‡¶æ‡¶∞ data ‡¶è‡¶∏‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡•§</li>
<li>‡¶§‡¶æ‡¶ï‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ runnable ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡ßü, ‡¶è‡¶¨‡¶Ç data ‡¶™‡ßú‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßü‡•§</li>
</ul>
<h3 id="-setting-up-garbage-collector-gc"><a class="header" href="#-setting-up-garbage-collector-gc">‚öôÔ∏è Setting Up Garbage Collector (GC)</a></h3>
<ul>
<li>Go runtime GC ‡¶ö‡¶æ‡¶≤‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ OS thread ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá, ‡¶Ø‡¶æ‡¶§‡ßá ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶ï‡¶æ‡¶ú ‡¶¨‡¶ø‡¶ò‡ßç‡¶® ‡¶®‡¶æ ‡¶ò‡¶ü‡ßá</li>
<li>thread ‡¶ó‡ßÅ‡¶≤‡ßã background-‡¶è silently ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá memory clean ‡¶∞‡¶æ‡¶ñ‡ßá</li>
<li>Go Runtime ‡¶™‡ßÅ‡¶∞‡ßã‡¶™‡ßÅ‡¶∞‡¶ø GC thread control ‡¶ï‡¶∞‡ßá</li>
</ul>
<h3 id="-go-scheduling"><a class="header" href="#-go-scheduling">üß† Go Scheduling</a></h3>
<p>Go runtime M:P:G model scheduling follow ‡¶ï‡¶∞‡ßá, ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá</p>
<ul>
<li>M = Machine (OS-level Thread) ‚Äî ‡¶Ø‡ßá‡¶ü‡¶æ ‡¶¨‡¶æ‡¶∏‡ßç‡¶§‡¶¨‡ßá CPU-‡¶§‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ö‡¶æ‡¶≤‡¶æ‡ßü‡•§</li>
<li>P = Processor (Logical Processor) ‚Äî ‡¶è‡¶ü‡¶ø goroutine run ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡ßÄ‡ßü execution context ‡¶ß‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡ßá, ‡¶Ø‡ßá‡¶Æ‡¶®: local run queue, stack, scheduler info ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø‡•§</li>
<li>G = Goroutine ‚Äî ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ø‡ßá‡¶∏‡¶¨ Go function/logic concurrently ‡¶ö‡¶æ‡¶≤‡¶æ‡¶á, ‡¶è‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá Go runtime ‚Äúgoroutine‚Äù ‡¶®‡¶æ‡¶Æ‡ßá ‡¶ö‡¶æ‡¶≤‡¶æ‡ßü‡•§</li>
</ul>
<h4 id="-go-scheduler-initialization"><a class="header" href="#-go-scheduler-initialization">üèóÔ∏è Go Scheduler Initialization</a></h4>
<p><strong>M (Machine, ‡¶¨‡¶æ OS Thread) ‡¶§‡ßà‡¶∞‡¶ø</strong></p>
<p>Go runtime ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá‡¶á exactly vCPU ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶ï machine thread (M) ‡¶§‡ßà‡¶∞‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø OS ‡¶ï‡ßá request ‡¶ï‡¶∞‡ßá‡•§</p>
<ul>
<li>1 core ‚Üí 2 vCPU ‚Üí 2 M</li>
<li>2 core ‚Üí 4 vCPU ‚Üí 4 M</li>
</ul>
<p><strong>P (Logical Processor) ‡¶§‡ßà‡¶∞‡¶ø</strong></p>
<p>üîπ Go runtime M ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶ï "Logical Processor" ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá, ‡¶Ø‡¶æ‡¶ï‡ßá P ‡¶¨‡¶≤‡¶æ ‡¶π‡ßü</p>
<ul>
<li>4 M : 4 P</li>
</ul>
<p>üîπ ‡¶è‡¶á P ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶Ö‡¶®‡ßá‡¶ï‡¶ü‡¶æ Virtual CPU (vCPU) ‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã</p>
<p>üîπ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶è‡¶ó‡ßÅ‡¶≤‡ßã hardware vCPU ‡¶®‡¶æ, ‡¶¨‡¶∞‡¶Ç Go runtime ‡¶è‡¶∞ internal scheduling unit</p>
<p><strong>G (Goroutine) ‡¶§‡ßà‡¶∞‡¶ø</strong></p>
<p>üî∏ Go runtime-‡¶è‡¶∞ ‡¶∏‡¶¨‡¶ö‡ßá‡ßü‡ßá lightweight execution unit ‡¶π‡¶ö‡ßç‡¶õ‡ßá Goroutine (G)</p>
<p>üî∏ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø <code>go someFunction()</code> ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶ï‡¶ü‡¶æ goroutine ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü</p>
<h3 id="-go-scheduler-1m--1p--2g-diagram"><a class="header" href="#-go-scheduler-1m--1p--2g-diagram">üß© Go Scheduler: 1M : 1P : 2G Diagram</a></h3>
<p>‡¶Æ‡¶®‡ßá ‡¶ï‡¶∞‡¶ø, 1M:1P:2G ‚Äî ‡¶è‡¶¨‡¶Ç ‡¶Æ‡¶®‡ßá ‡¶π‡¶ö‡ßç‡¶õ‡ßá 1P ‡¶¶‡ßÅ‡¶á‡¶ü‡¶æ goroutine ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶ö‡¶æ‡¶≤‡¶æ‡¶ö‡ßç‡¶õ‡ßá, ‡¶Ü‡¶∞ 1M ‡¶ö‡¶æ‡¶≤‡¶æ‡¶ö‡ßç‡¶õ‡ßá ‡¶∏‡ßá‡¶á 1P-‡¶ï‡ßá</p>
<pre><code class="language-markdown">                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚îÇ   Machine M  ‚îÇ  ‚Üê OS Thread (Executes G via P)
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
                               ‚ñº
                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚îÇ Logical P    ‚îÇ  ‚Üê Holds G run queue
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚ñº                             ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê             ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ Goroutine G1 ‚îÇ             ‚îÇ Goroutine G2 ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre>
<h3 id="-1-core-scenario-in-go-scheduler"><a class="header" href="#-1-core-scenario-in-go-scheduler">üß† 1 Core Scenario in Go Scheduler</a></h3>
<h4 id="-initialization-phase"><a class="header" href="#-initialization-phase">‚úÖ Initialization Phase:</a></h4>
<ul>
<li>OS ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡ßü ‚Üí 1 Core ‚áí 2 vCPU</li>
<li>‡¶§‡¶æ‡¶á Go runtime ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá:
<ul>
<li>2 Machine Thread (M)</li>
<li>2 Logical Processor (P)</li>
</ul>
</li>
</ul>
<pre><code class="language-markdown">          üß† Physical Core (1)
                ‚îÇ
        ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
        ‚ñº                ‚ñº
     M1 (Thread)      M2 (Thread)
       ‚îÇ                 ‚îÇ
       ‚ñº                 ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  P1 ‚îÇ           ‚îÇ  P2 ‚îÇ
    ‚îî‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò           ‚îî‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ                 ‚îÇ

‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê
‚îÇ G1,G2 ‚îÇ ‚îÇ G3,G4 ‚îÇ ‚Üê Each P has its G queue
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre>
<h3 id="-run-queue"><a class="header" href="#-run-queue">üß™ Run Queue</a></h3>
<p>Go ‡¶è‡¶∞ scheduler-‡¶è ‡ß® ‡¶ß‡¶∞‡¶®‡ßá‡¶∞ run queue ‡¶•‡¶æ‡¶ï‡ßá</p>
<h3 id="-‡ßß-local-run-queue-per-p"><a class="header" href="#-‡ßß-local-run-queue-per-p">üßµ ‡ßß. Local Run Queue (per P)</a></h3>
<p>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø Logical Processor (P) ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ú‡¶∏‡ßç‡¶¨ ‡¶è‡¶ï‡¶ü‡¶ø Run Queue ‡¶•‡¶æ‡¶ï‡ßá, ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá goroutine (G) ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡•§</p>
<h4 id="-‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá-‡¶ï‡¶æ‡¶ú-‡¶ï‡¶∞‡ßá"><a class="header" href="#-‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá-‡¶ï‡¶æ‡¶ú-‡¶ï‡¶∞‡ßá">üß© ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá:</a></h4>
<ul>
<li>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø P ‡¶è‡¶ï‡¶ü‡¶ø fixed-size circular run queue ‡¶Æ‡ßá‡¶á‡¶®‡¶ü‡ßá‡¶á‡¶® ‡¶ï‡¶∞‡ßá ‡¶Ø‡¶æ ring ‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã</li>
<li>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø Local Run Queue ‡¶è‡¶∞ slot 256 ‚Üí 256 goroutine</li>
<li>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø P ‡¶§‡¶æ‡¶∞ queue ‡¶è‡¶∞ G ‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá FIFO ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶ö‡¶æ‡¶≤‡¶æ‡ßü (First-In-First-Out).</li>
<li>‡¶Ø‡ßá‡¶á P ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá M ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶ö‡¶æ‡¶≤‡¶ø‡¶§ ‡¶π‡¶ö‡ßç‡¶õ‡ßá, ‡¶∏‡ßá‡¶á P ‡¶§‡¶æ‡¶∞ queue ‡¶•‡ßá‡¶ï‡ßá goroutine G ‡¶®‡¶ø‡ßü‡ßá ‡¶ö‡¶æ‡¶≤‡¶æ‡ßü‡•§</li>
<li>‡¶Ø‡¶¶‡¶ø ‡¶ï‡ßã‡¶® G ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡ßá (I/O, sleep etc), ‡¶§‡¶æ‡¶π‡¶≤‡ßá P ‡¶Ü‡¶¨‡¶æ‡¶∞ queue ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶§‡ßÅ‡¶® G ‡¶ö‡¶æ‡¶≤‡¶æ‡ßü‡•§</li>
<li>‡¶Ø‡¶¶‡¶ø P ‡¶è‡¶∞ queue ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶π‡ßü‡ßá ‡¶Ø‡¶æ‡ßü, ‡¶§‡¶æ‡¶π‡¶≤‡ßá:
<ul>
<li>‡¶∏‡ßá <code>work stealing</code> ‡¶ï‡¶∞‡ßá ‚Äî ‡¶Ö‡¶®‡ßç‡¶Ø P ‡¶è‡¶∞ queue ‡¶•‡ßá‡¶ï‡ßá G ‡¶ö‡ßÅ‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá ‡¶®‡ßá‡ßü‡•§</li>
</ul>
</li>
</ul>
<h3 id="-‡ß®-global-run-queue"><a class="header" href="#-‡ß®-global-run-queue">üåç ‡ß®. Global Run Queue</a></h3>
<p>‡¶Ø‡ßá‡¶∏‡¶¨ goroutine-‡¶ï‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü P-‡¶§‡ßá assign ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü ‡¶®‡¶æ, ‡¶∏‡ßá‡¶ó‡ßÅ‡¶≤‡ßã Global Run Queue-‡¶§‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡•§</p>
<ul>
<li>System-wide queue, ‡¶∏‡¶¨ P access ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§</li>
<li>Locking ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶™‡ßú‡ßá, ‡¶§‡¶æ‡¶á ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶ß‡ßÄ‡¶∞‡•§</li>
<li>‡¶Ø‡¶ñ‡¶® ‡¶ï‡ßã‡¶®‡ßã P-‡¶∞ local queue ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶π‡ßü, ‡¶§‡¶ñ‡¶® ‡¶∏‡ßá Global queue ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶æ‡¶ú ‡¶®‡ßá‡ßü‡•§</li>
</ul>
<blockquote>
<p>üîê Locking ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶è‡¶Æ‡¶® ‡¶è‡¶ï‡¶ü‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ, ‡¶Ø‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶è‡¶ï‡¶á ‡¶∏‡¶Æ‡ßü ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï goroutine ‡¶Ø‡ßá‡¶® ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶è‡¶ï‡¶á ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏‡ßá ‡¶π‡¶æ‡¶§ ‡¶®‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá, ‡¶∏‡ßá‡¶ü‡¶æ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡•§</p>
</blockquote>
<ul>
<li>
<p>newly created goroutines ‡¶Ø‡ßá local run queue ‡¶§‡ßá ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ ‡¶™‡¶æ‡¶¨‡ßá ‡¶¨‡¶∏‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§</p>
</li>
<li>
<p>logical processor free ‡¶•‡¶æ‡¶ï‡¶≤‡ßá local run queue ‡¶•‡ßá‡¶ï‡ßá goroutine ‡¶®‡¶ø‡ßü‡ßá execute ‡¶ï‡¶∞‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡ßá‡•§</p>
</li>
<li>
<p>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø local run queue ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡¶∞‡ßá goroutine execute ‡¶ï‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç slot ‡¶ó‡ßÅ‡¶≤‡ßã‡¶§‡ßá 256 ‡¶ü‡¶ø ‡¶ï‡¶∞‡ßá goroutines ‡¶•‡¶æ‡¶ï‡¶≤‡ßá newly created goroutines ‡¶ó‡ßÅ‡¶≤‡ßã global run queue ‡¶§‡ßá ‡¶ó‡¶ø‡ßü‡ßá ‡¶¨‡¶∏‡ßá</p>
</li>
<li>
<p>‡¶Ø‡¶¶‡¶ø local run queue ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶π‡ßü‡ßá ‡¶Ø‡¶æ‡ßü, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶∏‡ßá ‡¶Ö‡¶®‡ßç‡¶Ø P ‡¶è‡¶∞ queue ‡¶•‡ßá‡¶ï‡ßá half goroutines ‡¶®‡¶ø‡ßü‡ßá ‡¶®‡ßá‡ßü (this is called <code>Work Stealing</code>).</p>
</li>
<li>
<p>‡¶ï‡ßã‡¶® processor free ‡¶π‡¶≤‡ßá ‡¶è‡¶¨‡¶Ç ‡¶è‡¶∞ local run queue ‡¶§‡ßá ‡¶ï‡ßã‡¶® goroutine ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá, ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶®‡ßç‡¶Ø logical processor ‡¶è‡¶∞ local run queue ‡¶§‡ßá‡¶ì goroutines ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá (‡¶è‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá work stealing ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®‡¶æ) ‡¶è‡¶ü‡¶ø global run queue ‡¶•‡ßá‡¶ï‡ßá goroutines ‡¶®‡¶ø‡ßü‡ßá execute ‡¶ï‡¶∞‡ßá</p>
</li>
</ul>
<h3 id="-execution-of-maingo"><a class="header" href="#-execution-of-maingo">üîπ Execution of <code>main.go</code></a></h3>
<pre><code class="language-go">package main

import (
	"fmt"
	"net/http"
)

func handler(w http.ResponseWriter, r *http.Request) {
	w.Header().Set("Content-Type", "application/json")
	fmt.Fprintln(w, "hello world")
}

func aboutHandler(w http.ResponseWriter, r *http.Request) {
	fmt.Fprintln(w, "About page")
}

func main() {
	mux := http.NewServeMux()
	mux.HandleFunc("/", handler)
	mux.HandleFunc("/about", aboutHandler)

	fmt.Println("Server running on :8080")
	err := http.ListenAndServe(":8080", mux)
	if err != nil {
		fmt.Println("Error starting server", err)
	}
}
</code></pre>
<pre><code class="language-bash">go build main.go
./main
</code></pre>
<h4 id="-go-program-memory-layout"><a class="header" href="#-go-program-memory-layout">üì¶ Go Program Memory Layout</a></h4>
<pre><code class="language-markdown">                        +----------------------------+
                        |        Code Segment        |
                        |----------------------------|
                        | - func handler             |
                        | - func aboutHandler        |
                        | - func main                |
                        | - imported fmt, net/http   |
                        +----------------------------+

                        +----------------------------+
                        |       Data Segment         |
                        |----------------------------|
                        | - Static/global data       |
                        | - Function/method metadata |
                        | - String constants         |
                        |   e.g., "hello world"      |
                        |         "About page"       |
                        |         ":8080"            |
                        +----------------------------+

                        +----------------------------+
                        |           Heap             |
                        |----------------------------|
                        | - Dynamically allocated    |
                        |   memory during runtime    |
                        | - mux := http.NewServeMux()|
                        | - Each request's data      |
                        | - Goroutines' data         |
                        +----------------------------+

                        +----------------------------+
                        |           Stack            |
                        |----------------------------|
                        | - Go Runtime Code          |
                        |                            |
                        +----------------------------+
</code></pre>
<h3 id="-go-http-server-execution"><a class="header" href="#-go-http-server-execution">üåÄ Go HTTP Server Execution</a></h3>
<p><strong>üîπ ‡ßß. Go ‡¶∞‡¶æ‡¶®‡¶ü‡¶æ‡¶á‡¶Æ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá:</strong></p>
<ul>
<li>Go ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡¶≤‡ßá:
<ul>
<li>‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá <strong>init()</strong> ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶ó‡ßÅ‡¶≤‡ßã (‡¶Ø‡¶¶‡¶ø ‡¶•‡¶æ‡¶ï‡ßá) execute ‡¶π‡¶Ø‡¶º‡•§</li>
<li>‡¶è‡¶∞‡¶™‡¶∞ memory layout ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ code segment, data segment, ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™ ‡¶π‡¶Ø‡¶º‡•§</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ß®. Main Thread &amp; Stack Setup</strong></p>
<ul>
<li>Go runtime ‡¶è‡¶ï‡¶ü‡¶æ main OS thread ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶á ‡¶•‡ßç‡¶∞‡ßá‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶æ main stack allocate ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶á stack-‡¶è runtime code ‡¶ì ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø execution ‡¶ö‡¶≤‡¶¨‡ßá‡•§</li>
</ul>
<p><strong>üîπ ‡ß©. Main Goroutine ‡¶§‡ßà‡¶∞‡¶ø</strong></p>
<ul>
<li>Go automatically ‡¶è‡¶ï‡¶ü‡¶æ main goroutine ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶∞ initial stack size ‡¶π‡ßü 2KB (heap-‡¶è allocate ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü)‡•§</li>
<li>‡¶è‡¶á goroutine ‡¶•‡¶æ‡¶ï‡¶¨‡ßá local run queue-‡¶§‡ßá‡•§</li>
</ul>
<p><strong>üîπ ‡ß™. Scheduler ‡¶è‡¶¨‡¶Ç Processor</strong></p>
<ul>
<li>Go runtime-‡¶è ‡¶Ü‡¶õ‡ßá:
<ul>
<li>M (Machine = Thread)</li>
<li>P (Processor = Logical executor)</li>
<li>G (Goroutine)</li>
</ul>
</li>
<li>‡¶Ø‡¶ñ‡¶® Go start ‡¶π‡ßü, main goroutine local run queue ‡¶§‡ßá enqueue ‡¶π‡ßü‡•§</li>
<li>‡¶è‡¶ï‡¶ü‡¶ø P (logical processor) active ‡¶•‡¶æ‡¶ï‡ßá ‚Äî ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶∏‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶è‡¶á ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§‡ßá ‡¶è‡¶ï‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ main goroutine-‡¶ü‡¶æ‡¶á active‡•§</li>
<li>‡¶Ö‡¶®‡ßç‡¶Ø P ‡¶ó‡ßÅ‡¶≤‡ßã sleep ‡¶ï‡¶∞‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá ‡¶Ø‡¶¶‡¶ø ‡¶Ü‡¶∞ ‡¶ï‡ßã‡¶®‡ßã goroutine ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá‡•§</li>
</ul>
<p><strong>üîπ ‡ß´. main() Function Execution ‡¶∂‡ßÅ‡¶∞‡ßÅ</strong></p>
<ul>
<li>Main goroutine-‡¶è‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞:
<ul>
<li>main() function-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶æ stack frame ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü‡•§</li>
<li>‡¶§‡¶æ‡¶∞‡¶™‡¶∞ main() ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° execute ‡¶π‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡ßá‡•§</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ß¨. Router Creation</strong></p>
<ul>
<li>http.NewServeMux() ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü:
<ul>
<li>‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ServeMux object ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶á object ‡¶ü‡¶ø main goroutine-‡¶è‡¶∞ stack frame ‡¶è ‡¶•‡¶æ‡¶ï‡ßá‡•§</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ß≠. Route Register</strong></p>
<ul>
<li>mux.Handle("/", handler):
<ul>
<li>Mux object-‡¶è‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞‡ßá route pattern ‡¶ì handler function register ‡¶π‡ßü‡•§</li>
<li>‡¶è‡¶ó‡ßÅ‡¶≤‡ßã map ‡¶Ü‡¶ï‡¶æ‡¶∞‡ßá ServeMux struct-‡¶è store ‡¶π‡ßü‡•§</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ßÆ. Server Start</strong></p>
<ul>
<li>http.ListenAndServe(":8080", mux):
<ul>
<li>‡¶è‡¶ü‡¶æ main goroutine ‡¶•‡ßá‡¶ï‡ßá call ‡¶π‡ßü‡•§</li>
<li>‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® stack frame ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü‡•§</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ßØ. Internal serve() Call</strong></p>
<ul>
<li>ListenAndServe() ‡¶è‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞:
<ul>
<li>srv.Serve(l net.Listener) function call ‡¶π‡ßü‡•§</li>
<li>‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶ø stack frame ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü‡•§</li>
</ul>
</li>
</ul>
<p><strong>üîÇ üîÅ ‡ßß‡ß¶. Server-‡¶è‡¶∞ Infinite Loop</strong></p>
<ul>
<li>Serve() function-‡¶è‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞‡ßá ‡¶•‡¶æ‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶ø infinite for loop:
<ul>
<li>‡¶Ø‡ßá‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø iteration-‡¶è ‡¶ï‡¶∞‡ßá:
<ul>
<li>Accept() ‡¶ï‡¶∞‡ßá ‡¶®‡¶§‡ßÅ‡¶® connection‡•§</li>
<li>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø connection ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® goroutine ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶∏‡ßá‡¶á goroutine handle ‡¶ï‡¶∞‡ßá HTTP request-response‡•§</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="language-markdown">Program Start
‚îÇ
‚îú‚îÄ&gt; Execute init()
‚îú‚îÄ&gt; Setup code/data segment
‚îú‚îÄ&gt; Create main thread + main stack
‚îú‚îÄ&gt; Create main goroutine (2KB heap stack)
‚îÇ
‚îî‚îÄ&gt; main goroutine enqueued ‚Üí local run queue ‚Üí executed by P

Main Goroutine:
‚îÇ
‚îú‚îÄ&gt; main() stack frame created
‚îÇ ‚îú‚îÄ&gt; mux := http.NewServeMux()
‚îÇ ‚îú‚îÄ&gt; mux.Handle("/", handler)
‚îÇ ‚îî‚îÄ&gt; http.ListenAndServe(":8080", mux)
‚îÇ ‚îî‚îÄ&gt; srv.Serve(listener)
‚îÇ ‚îî‚îÄ&gt; infinite for loop
‚îÇ ‚îî‚îÄ&gt; accept conn ‚Üí new goroutine ‚Üí handle request
</code></pre>
<pre><code class="language-go">for {
    rw, err := l.Accept()
    go c.serve(connCtx)
}
</code></pre>
<h3 id="-go-http-server-accepts-connection-and-handles-it"><a class="header" href="#-go-http-server-accepts-connection-and-handles-it">üß† Go HTTP Server accepts connection and handles it</a></h3>
<p><strong>üîπ ‡ßß. l.Accept() ‡¶ï‡¶≤ ‡¶π‡ßü</strong></p>
<ul>
<li>‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø network socket accept call‡•§</li>
<li>‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® stack frame ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡•§</li>
<li>‡¶è‡¶∞ ‡¶ï‡¶æ‡¶ú ‡¶π‡¶ö‡ßç‡¶õ‡ßá:
<ul>
<li>‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßá‡¶â connect ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶á‡¶≤‡ßá, ‡¶§‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá communication ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ‡•§</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ß®. Accept() ‡¶ï‡ßÄ ‡¶ï‡¶∞‡ßá?</strong></p>
<ul>
<li>main goroutine ‚Üí Accept() call ‡¶ï‡¶∞‡ßá ‚Üí ‡¶è‡¶ü‡¶ø Go runtime ‡¶ï‡ßá ‡¶¨‡¶≤‡ßá:
<ul>
<li>‚Äú‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶æ socket ‡¶¶‡¶æ‡¶ì, ‡¶Ø‡¶æ‡¶§‡ßá ‡¶Ü‡¶Æ‡¶ø ‡¶®‡¶§‡ßÅ‡¶® connection handle ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø‡•§‚Äù</li>
<li>Go runtime ‡¶§‡¶ñ‡¶® ‡¶¶‡ßá‡¶ñ‡ßá, ‚Äú‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶ï‡¶ø socket ‡¶Ü‡¶ó‡ßá ‡¶•‡ßá‡¶ï‡ßá‡¶á ready ‡¶Ü‡¶õ‡ßá?‚Äù</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ß©. Socket ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶ï‡ßÄ ‡¶π‡ßü?</strong></p>
<ul>
<li>‡¶Ø‡¶¶‡¶ø socket ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá:
<ul>
<li>Go runtime ‚Üí epoll_ctl() call ‡¶ï‡¶∞‡ßá ‚Üí kernel ‡¶ï‡ßá ‡¶¨‡¶≤‡ßá:
<ul>
<li>‚Äú‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶è‡¶ï‡¶ü‡¶æ socket ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßã ‡¶è‡¶¨‡¶Ç future-‡¶è ready ‡¶π‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶ø‡¶ì‡•§‚Äù</li>
</ul>
</li>
</ul>
</li>
<li>‡¶è‡¶á ‡¶ï‡¶æ‡¶ú‡¶ü‡¶æ Go-‡¶è‡¶∞ netpoll library ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡•§</li>
</ul>
<p><strong>üîπ ‡ß™. epoll_ctl ‚Üí kernel</strong></p>
<ul>
<li>epoll_ctl() ‡¶è‡¶ï‡¶ü‡¶æ asynchronous system call:
<ul>
<li>‡¶Æ‡¶æ‡¶®‡ßá ‡¶è‡¶ü‡¶æ main goroutine ‡¶ï‡ßá block ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ‡•§</li>
<li>Go runtime meanwhile ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶ï‡¶æ‡¶ú ‡¶ö‡¶æ‡¶≤‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ß´. Linux kernel ‡¶ï‡ßÄ ‡¶ï‡¶∞‡ßá?</strong></p>
<ul>
<li>Linux-‡¶è ‡¶∏‡¶¨‡¶ï‡¶ø‡¶õ‡ßÅ file ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá treat ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º (socket, file, device ‚Äî ‡¶∏‡¶¨‡¶ï‡¶ø‡¶õ‡ßÅ)‡•§</li>
<li>Kernel ‡¶è‡¶ï‡¶ü‡¶ø socket ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá ‚Äî ‡¶è‡¶ü‡¶æ ‡¶è‡¶ï ‡¶™‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§ ‡¶Ø‡¶æ ‡¶¶‡¶ø‡ßü‡ßá data ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶ì ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º (like pipe)‡•§</li>
<li>‡¶è‡¶á socket-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø kernel ‡¶è‡¶ï‡¶ü‡¶ø file descriptor (FD) ‡¶¶‡ßá‡¶Ø‡¶º‡•§
<ul>
<li>‡¶Ø‡ßá‡¶Æ‡¶®, ‡¶ß‡¶∞‡ßã FD = 5</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ß¨. Main Thread Sleep ‡¶ï‡¶∞‡ßá</strong></p>
<ul>
<li>main goroutine ‡¶§‡¶ñ‡¶® sleep ‡¶ï‡¶∞‡ßá ‡¶•‡¶æ‡¶ï‡ßá, ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶∏‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶õ‡ßá ‡¶®‡¶§‡ßÅ‡¶® socket connection-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§</li>
<li>‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶è‡¶á ‡¶∏‡¶Æ‡ßü‡ßá‡¶ì Go runtime ‡¶¨‡¶®‡ßç‡¶ß ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ ‚Äî ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø goroutine ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§</li>
</ul>
<p><strong>üîπ ‡ß≠. New Connection ‡¶è‡¶≤‡ßá</strong></p>
<ul>
<li>‡¶ï‡ßá‡¶â ‡¶Ø‡¶ñ‡¶® connect ‡¶ï‡¶∞‡ßá:
<ul>
<li>Kernel ‡¶¨‡¶≤‡ßá: ‚Äú‡¶è‡¶á socket (FD 5) now ready!‚Äù</li>
<li>Go runtime ‡¶è‡¶∞ netpoller ‡¶ú‡ßá‡¶ó‡ßá ‡¶â‡¶†‡ßá (via epoll_wait) ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßá‡¶á connection ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡ßá‡•§</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ßÆ. New goroutine handle ‡¶ï‡¶∞‡ßá</strong></p>
<ul>
<li>‡¶§‡¶æ‡¶∞‡¶™‡¶∞ Go runtime:
<ul>
<li><code>go c.serve(connCtx)</code> ‡¶ï‡¶≤ ‡¶ï‡¶∞‡ßá</li>
<li>‡¶®‡¶§‡ßÅ‡¶® goroutine ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º ‚Üí ‡¶è‡¶ü‡¶ø ‡¶∏‡ßá‡¶á connection ‡¶è‡¶∞ request/response handle ‡¶ï‡¶∞‡ßá</li>
</ul>
</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>Step</th><th>Description</th></tr></thead><tbody>
<tr><td>1Ô∏è‚É£</td><td><code>Accept()</code> call ‚Üí ‡¶®‡¶§‡ßÅ‡¶® connection ‡¶ö‡¶æ‡¶á</td></tr>
<tr><td>2Ô∏è‚É£</td><td>Go runtime checks ‚Üí socket available?</td></tr>
<tr><td>3Ô∏è‚É£</td><td>‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‚Üí <code>epoll_ctl()</code> ‚Üí kernel socket ‡¶§‡ßà‡¶∞‡¶ø</td></tr>
<tr><td>4Ô∏è‚É£</td><td>Kernel ‚Üí socket ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá (e.g. FD = 5)</td></tr>
<tr><td>5Ô∏è‚É£</td><td>main goroutine sleeps ‚Üí non-blocking epoll</td></tr>
<tr><td>6Ô∏è‚É£</td><td>New connection ‡¶è‡¶≤‡ßá ‚Üí <code>epoll_wait</code> wakes Go runtime</td></tr>
<tr><td>7Ô∏è‚É£</td><td><code>go c.serve()</code> ‚Üí new goroutine handles request</td></tr>
</tbody></table>
</div>
<h3 id="-‡¶Ø‡¶ñ‡¶®-‡¶è‡¶ï‡¶ü‡¶ø-http-request-‡¶ï‡¶∞‡¶æ-‡¶π‡¶Ø--‡¶≠‡¶ø‡¶§‡¶∞‡ßá‡¶∞-‡¶ú‡¶ó‡ßé-go-http-server--os--nic--kernel"><a class="header" href="#-‡¶Ø‡¶ñ‡¶®-‡¶è‡¶ï‡¶ü‡¶ø-http-request-‡¶ï‡¶∞‡¶æ-‡¶π‡¶Ø--‡¶≠‡¶ø‡¶§‡¶∞‡ßá‡¶∞-‡¶ú‡¶ó‡ßé-go-http-server--os--nic--kernel">üåê ‡¶Ø‡¶ñ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø HTTP Request ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º ‚Äî ‡¶≠‡¶ø‡¶§‡¶∞‡ßá‡¶∞ ‡¶ú‡¶ó‡ßé (Go HTTP Server + OS + NIC + Kernel)</a></h3>
<p><strong>üîπ ‡ßß. ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ URL ‡¶¶‡¶ø‡¶á (‡¶Ø‡ßá‡¶Æ‡¶®: http://localhost:8080/)</strong></p>
<ul>
<li>‡¶è‡¶á request ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶Ø‡¶æ‡ßü router ‚Üí router ‚Üí server router ‡¶è‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá (DNS resolve ‡¶ß‡¶∞‡ßá ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá)‡•§</li>
</ul>
<p><strong>üîπ ‡ß®. Server ‡¶è‡¶∞ Network Interface</strong></p>
<ul>
<li>Server-side ‡¶è‡¶∞ Network Interface Controller (NIC) ‚Äî ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá Ethernet Cable ‡¶¨‡¶æ Wi-Fi Adapter ‚Äî ‡¶è‡¶á request ‡¶ß‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶á NIC data ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶≤‡ßá‡¶ñ‡ßá ‡¶§‡¶æ‡¶∞ NIC Receive Buffer (RAM ‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶Ö‡¶Ç‡¶∂) ‡¶è‡•§</li>
</ul>
<p>**üîπ ‡ß©. NIC Interrupt **</p>
<ul>
<li>‡¶Ø‡ßá‡¶á ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§‡ßá NIC data ‡¶™‡¶æ‡¶Ø‡¶º, ‡¶∏‡ßá ‡¶§‡¶ñ‡¶® Interrupt Signal ‡¶™‡¶æ‡¶†‡¶æ‡¶Ø‡¶º Kernel ‡¶ï‡ßá‡•§</li>
<li>Kernel ‡¶§‡¶ñ‡¶® ‡¶è‡¶∏‡ßá NIC Receive Buffer ‡¶•‡ßá‡¶ï‡ßá data ‡¶™‡¶°‡¶º‡ßá‡•§</li>
</ul>
<p><strong>üîπ ‡ß™. Kernel ‚Üí Socket Receive Buffer</strong></p>
<ul>
<li>Kernel data ‡¶ï‡ßá write ‡¶ï‡¶∞‡ßá Socket Receive Buffer ‡¶è (‡¶Ø‡ßá‡¶ü‡¶æ File Descriptor fd 5 ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§)‡•§</li>
</ul>
<p><strong>üîπ ‡ß´. Kernel ‚Üí fd 5 Ready</strong></p>
<ul>
<li>‡¶è‡¶∞‡¶™‡¶∞ Kernel fd 5 ‡¶ï‡ßá ready for read ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá mark ‡¶ï‡¶∞‡ßá‡•§</li>
</ul>
<p><strong>üîπ ‡ß¨. epoll_wait() ‚Üí Wake Up</strong></p>
<ul>
<li>‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ Go runtime epoll_wait() ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶õ‡¶ø‡¶≤, kernel ‡¶è‡¶ñ‡¶®:
<ul>
<li>‡¶∏‡ßá‡¶á sleeping epoll_wait() thread ‡¶ï‡ßá wake ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶¨‡¶Ç ‡¶¨‡¶≤‡ßá: ‚Äúfd 5 ‡¶è‡¶ñ‡¶® ready‡•§‚Äù</li>
</ul>
</li>
</ul>
<p><strong>üîπ ‡ß≠. epoll_wait ‚Üí Go Runtime</strong></p>
<ul>
<li>epoll_wait() ‡¶è‡¶á fd 5 ‡¶ï‡ßá Go runtime ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶Ø‡¶º‡•§</li>
</ul>
<p><strong>üîπ ‡ßÆ. Go Runtime ‚Üí Sleeping Goroutines</strong></p>
<ul>
<li>Go runtime ‡¶¶‡ßá‡¶ñ‡ßá, ‚Äú‡¶è‡¶á fd 5 ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã goroutine ‡¶Ü‡¶ó‡ßá ‡¶•‡ßá‡¶ï‡ßá ‡¶ò‡ßÅ‡¶Æ‡¶ø‡¶Ø‡¶º‡ßá ‡¶õ‡¶ø‡¶≤‡ßã?‚Äù</li>
<li>‡¶Ø‡¶¶‡¶ø ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶¨‡ßá ‡¶∏‡ßá‡¶á goroutine ‡¶ï‡ßá wake ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶∞‡¶™‡¶∞ Go runtime ‡¶è‡¶∞ scheduler ‡¶∏‡ßá‡¶á goroutine ‡¶ï‡ßá Local Run Queue ‡¶§‡ßá ‡¶∞‡¶æ‡¶ñ‡ßá‡•§</li>
<li>‡¶è‡¶ï‡¶ü‡¶ø Logical Processor (P) ‡¶∏‡ßá‡¶á goroutine ‡¶ü‡¶ø ‡¶ö‡¶æ‡¶≤‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø dedicated OS thread (M) ‡¶™‡¶æ‡¶Ø‡¶º‡•§</li>
</ul>
<p><strong>üîπ üîÅ Execution ‡¶∂‡ßÅ‡¶∞‡ßÅ</strong></p>
<ul>
<li>‡¶∏‡ßá‡¶á Logical Processor ‡¶è‡¶ñ‡¶® main goroutine execute ‡¶ï‡¶∞‡ßá‡•§</li>
<li>Go runtime fd 5 ‡¶ï‡ßá main goroutine ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶Ø‡¶º‡•§</li>
</ul>
<p><strong>üîπ üîç Data Read ‡¶π‡ßü</strong></p>
<ul>
<li>‡¶è‡¶ñ‡¶® main goroutine fd 5 ‡¶•‡ßá‡¶ï‡ßá data ‡¶™‡¶°‡¶º‡ßá</li>
<li>socket receive buffer ‡¶•‡ßá‡¶ï‡ßá data ‡¶Ü‡¶∏‡ßá</li>
<li>rw ‚Üí data store ‡¶π‡ßü</li>
</ul>
<p><strong>üîπ üöÄ Serve ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® goroutine ‡¶§‡ßà‡¶∞‡¶ø</strong></p>
<ul>
<li>‡¶è‡¶∞‡¶™‡¶∞ Go runtime <code>go c.serve(connCtx)</code> ‡¶ï‡¶≤ ‡¶ï‡¶∞‡ßá<br />
-‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶ï‡¶ü‡¶æ goroutine ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º</li>
</ul>
<p>‡¶è‡¶á goroutine ‡¶ü‡¶ø rw ‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡¶æ data ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá HTTP request handle ‡¶ï‡¶∞‡ßá‡•§</p>
<p><strong>üîÑ ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ request-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ</strong></p>
<ul>
<li>‡¶è‡¶∞‡¶™‡¶∞ main goroutine ‡¶Ü‡¶¨‡¶æ‡¶∞ <code>l.Accept()</code> ‡¶è ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§</li>
<li>Go runtime ‡¶ú‡¶æ‡¶®‡ßá ‡¶Ø‡ßá ‡¶Ü‡¶ó‡ßá‡¶á socket (fd 5) ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§</li>
<li>‡¶∏‡ßá ‡¶è‡¶ñ‡¶® new incoming request ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßá‡•§</li>
</ul>
<p><strong>üîÅ ‡¶®‡¶§‡ßÅ‡¶® data ‡¶è‡¶≤‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞‡ßã ‡¶è‡¶ï‡¶á cycle</strong></p>
<ul>
<li>
<p>NIC ‚Üí kernel ‚Üí socket receive buffer ‚Üí mark fd ready ‚Üí wake epoll_wait</p>
</li>
<li>
<p>Go runtime ‚Üí wake goroutine ‚Üí read ‚Üí serve</p>
</li>
</ul>
<p>‡¶è‡¶≠‡¶æ‡¶¨‡ßá‡¶á ‡¶è‡¶ï‡¶ü‡¶ø HTTP server concurrency + efficiency ‡¶∏‡¶π‡¶ï‡¶æ‡¶∞‡ßá thousands of connections handle ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§</p>
<pre><code class="language-markdown">Client Request (Browser)
‚Üì
Router ‚Üí Server NIC ‚Üí NIC Buffer (RAM)
‚Üì (Interrupt)
Linux Kernel ‚Üí Copy to Socket Buffer (fd 5)
‚Üì
Mark fd 5 ready ‚Üí Wake epoll_wait()
‚Üì
Go Runtime ‚Üí Finds sleeping goroutine
‚Üì
Wake up ‚Üí Scheduler ‚Üí Local Run Queue ‚Üí OS Thread
‚Üì
Execute main goroutine
‚Üì
main goroutine reads from fd 5 ‚Üí rw = l.Accept()
‚Üì
go c.serve(connCtx) ‚Üí spawn goroutine to handle
‚Üì
main goroutine again waits for next request...
</code></pre>
<h3 id="-newly-spawned-goroutine"><a class="header" href="#-newly-spawned-goroutine">üì¶ Newly Spawned goroutine</a></h3>
<ul>
<li>‡¶Ø‡¶ñ‡¶® <code>go c.serve(connCtx)</code> ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® goroutine spawn ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º,
‡¶§‡¶ñ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® stack ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º, ‡¶è‡¶¨‡¶Ç ‡¶è‡¶á stack ‡¶ü‡¶ø heap memory ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡•§</li>
<li>Go ‡¶§‡ßá goroutine ‡¶è‡¶∞ stack ‡¶õ‡ßã‡¶ü (‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá 2KB), ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶è‡¶ü‡¶ø dynamic ‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡¶æ‡ßú‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§</li>
<li>‡¶è‡¶á goroutine ‡¶ü‡¶ø ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ local run queue ‡¶§‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶Ø‡¶º, ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ö‡¶®‡ßá‡¶ï goroutine ‡¶≤‡¶æ‡¶á‡¶® ‡¶ß‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßá‡•§</li>
<li>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø logical processor (P) ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶è‡¶ï‡¶ü‡¶ø dedicated OS thread (M) mapped ‡¶•‡¶æ‡¶ï‡ßá‡•§ ‡¶è‡¶á logical processor (P) ‡¶∏‡ßá‡¶á local run queue ‡¶•‡ßá‡¶ï‡ßá goroutine ‡¶ü‡¶ø‡¶ï‡ßá ‡¶§‡ßÅ‡¶≤‡ßá ‡¶®‡ßá‡ßü ‡¶è‡¶¨‡¶Ç execution ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßá‡•§</li>
</ul>
<blockquote>
<p>üßµ goroutine spawn = ‚Äú‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø lightweight thread ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá ‡¶∏‡ßá‡¶ü‡¶æ‡¶ï‡ßá ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ‡•§‚Äù</p>
</blockquote>
<h3 id="-mux-‡¶è‡¶¨‡¶Ç-handler-execution-‡¶ß‡¶æ‡¶™"><a class="header" href="#-mux-‡¶è‡¶¨‡¶Ç-handler-execution-‡¶ß‡¶æ‡¶™">‚úÖ mux ‡¶è‡¶¨‡¶Ç handler execution ‡¶ß‡¶æ‡¶™:</a></h3>
<ul>
<li>‡¶è‡¶∞ ‡¶Ü‡¶ó‡ßá server ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá mux (‡¶Ø‡ßá‡¶Æ‡¶® <code>http.NewServeMux()</code>) ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßá‡¶ñ‡¶æ‡¶®‡ßá <code>HandleFunc()</code> ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá route ‡¶ì handler function register ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§</li>
<li>goroutine ‡¶ì‡¶á router-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¶‡ßá‡¶ñ‡ßá, request-‡¶è‡¶∞ URL path /about ‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶ï‡ßã‡¶® route ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá match ‡¶ï‡¶∞‡ßá ‡¶ï‡¶ø‡¶®‡¶æ‡•§</li>
<li>‡¶®‡¶§‡ßÅ‡¶® goroutine ‡¶Ø‡¶ñ‡¶® ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡¶Ø‡¶º, ‡¶§‡¶ñ‡¶® request-‡¶è‡¶∞ URL path, header, ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø metadata ‡¶¶‡ßá‡¶ñ‡ßá ‡¶¨‡ßã‡¶ù‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßá, ‡¶ï‡ßã‡¶® route ‡¶¨‡¶æ path ‡¶ü‡¶ø ‡¶Æ‡¶ø‡¶≤‡ßá ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá‡•§</li>
<li>‡¶Ø‡¶ñ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø HTTP request ‡¶Ü‡¶∏‡ßá, ‡¶§‡¶ñ‡¶® router ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶∏‡ßá‡¶á URL path ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ï‡ßã‡¶® pattern match ‡¶ï‡¶∞‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßá‡¶á ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ handler function execute ‡¶ï‡¶∞‡ßá‡•§
<ul>
<li>‡¶Ø‡ßá‡¶Æ‡¶® goroutine ‡¶ì‡¶á router-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¶‡ßá‡¶ñ‡ßá, request-‡¶è‡¶∞ URL path <code>/about</code> ‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶ï‡ßã‡¶® route ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá match ‡¶ï‡¶∞‡ßá ‡¶ï‡¶ø‡¶®‡¶æ‡•§</li>
<li><code>/about</code> path ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø <code>aboutHandler()</code> ‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ handler function register ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶õ‡ßá‡•§</li>
</ul>
</li>
<li>handler match ‡¶π‡¶¨‡¶æ‡¶∞ ‡¶™‡¶∞, ‡¶∏‡ßá‡¶á matched handler function ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® stack frame ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º, ‡¶Ø‡¶æ‡¶§‡ßá ‡¶ì‡¶á ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶ü‡¶ø ‡¶§‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° execute ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§
<ul>
<li>‡¶Ø‡¶ñ‡¶® <code>aboutHandler()</code> ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡ßü:
<ul>
<li>‡¶§‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® stack frame ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º, ‡¶Ø‡¶æ‡¶§‡ßá ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° execute ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§</li>
<li>‡¶è‡¶á ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® <code>w (response writer)</code> &amp; <code>fprintln</code> ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá socket ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá <code>"About page"</code> write ‡¶ï‡¶∞‡ßá‡•§</li>
<li>socket send buffer ‡¶è syscall ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá data store ‡¶π‡ßü‡•§</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="-nic-‡¶è-‡¶°‡ßá‡¶ü‡¶æ-‡¶Ø‡¶æ‡¶ì‡ßü‡¶æ‡¶∞-‡¶™‡¶∞‡¶∏‡ßá‡¶∏"><a class="header" href="#-nic-‡¶è-‡¶°‡ßá‡¶ü‡¶æ-‡¶Ø‡¶æ‡¶ì‡ßü‡¶æ‡¶∞-‡¶™‡¶∞‡¶∏‡ßá‡¶∏">üß† NIC-‡¶è ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ø‡¶æ‡¶ì‡ßü‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏</a></h3>
<ul>
<li><strong>Go app ‡¶•‡ßá‡¶ï‡ßá socket</strong>
<ul>
<li>fmt.Fprintln(w, "About page") ‚Üí Go runtime ResponseWriter ‡¶è‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞‡ßá Write() method call ‡¶ï‡¶∞‡ßá ‚Üí ‡¶Ö‡¶¨‡¶∂‡ßá‡¶∑‡ßá <code>syscall.Write()</code> ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá kernel <em>socket send buffer</em> ‡¶è data ‡¶ú‡¶Æ‡¶æ ‡¶π‡ßü‡•§</li>
<li><code>ResponseWriter.Write()</code> ‚Üí ‡¶Ö‡¶¨‡¶∂‡ßá‡¶∑‡ßá Go syscall layer-‡¶è ‡¶ó‡¶ø‡ßü‡ßá syscall.Write() call ‡¶π‡ßü‡•§</li>
<li><code>syscall.Write()</code> ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá data kernel space-‡¶è ‡¶Ø‡¶æ‡ßü ‡¶è‡¶¨‡¶Ç Socket Send Buffer ‡¶è ‡¶ú‡¶Æ‡¶æ ‡¶π‡ßü‡•§</li>
<li>Kernel ‡¶§‡¶ñ‡¶® socket FD (File Descriptor) ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ check ‡¶ï‡¶∞‡ßá data ready ‡¶ï‡¶ø‡¶®‡¶æ‡•§</li>
</ul>
</li>
<li><strong>Kernel ‡¶•‡ßá‡¶ï‡ßá NIC</strong>
<ul>
<li>Kernel-‡¶è‡¶∞ network stack ‡¶∏‡ßá‡¶á data ‡¶ï‡ßá ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü ‡¶ï‡¶∞‡ßá (TCP/IP header ‡¶∏‡¶π) NIC-‡¶è‡¶∞ <em>TX (Transmit) ring buffer</em>-‡¶è ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶π‡ßü (‡¶è‡¶ü‡¶æ <em>hardware circular queue</em>)‡•§</li>
</ul>
</li>
<li><strong>NIC ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü ‡¶®‡ßá‡ßü ‡¶è‡¶¨‡¶Ç Physical Layer-‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡ßü</strong>
<ul>
<li>NIC Controller ‚Üí DMA (Direct Memory Access) ‡¶¶‡¶ø‡ßü‡ßá data ring buffer ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡ßú‡ßá ‚Üí electromagnetic signal ‡¶Ü‡¶ï‡¶æ‡¶∞‡ßá Ethernet cable / WiFi ‡¶¶‡¶ø‡ßü‡ßá router/switch-‡¶è‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡ßü‡•§</li>
</ul>
</li>
<li><strong>Router hopping</strong>
<ul>
<li>‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï router, switch ‡¶è‡¶¨‡¶Ç network node ‡¶™‡¶æ‡¶∞ ‡¶π‡ßü‡ßá destination client (user-‡¶è‡¶∞ PC ‡¶¨‡¶æ mobile) ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶™‡ßå‡¶Å‡¶õ‡¶æ‡ßü‡•§</li>
</ul>
</li>
<li><strong>Client receives</strong>
<ul>
<li>Client ‡¶è‡¶∞ NIC ‚Üí OS ‚Üí Browser ‚Üí renders <strong>"About page"</strong></li>
</ul>
</li>
</ul>
<pre><code class="language-plaintext">+--------------------+               +-----------------+
|  Go Application    |               |     Kernel      |
|--------------------|               |-----------------|
| fmt.Fprintln(w,‚Ä¶)  |               |                 |
|   ‚Üì                |               | syscall.Write() |
| ResponseWriter     |               |   ‚Üì             |
|   ‚Üì                |               | Socket Buffer   |
+--------------------+               |   ‚Üì             |
                                     | NIC Driver      |
                                     +--------‚Üì--------+
                                              |
                           +------------------‚Üì-------------------+
                           |       NIC TX Ring Buffer (DMA)       |
                           +------------------‚Üì-------------------+
                                              |
                                 Electromagnetic Signal
                                              ‚Üì
                                        Ethernet/WiFi
                                              ‚Üì
                                           Router
                                              ‚Üì
                                          Client PC
                                        "About page"

</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Meaning</th></tr></thead><tbody>
<tr><td><strong>Socket</strong></td><td>2-way data pipe, communication endpoint</td></tr>
<tr><td><strong>File Descriptor (FD)</strong></td><td>kernel-assigned number for tracking sockets/files</td></tr>
<tr><td><strong>epoll_ctl</strong></td><td>kernel ‡¶ï‡ßá ‡¶¨‡¶≤‡¶ø ‚Äî ‚Äú‡¶è‡¶á socket ready ‡¶π‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶ø‡¶ì‚Äù</td></tr>
<tr><td><strong>epoll_wait</strong></td><td>Go runtime waits here ‚Äî non-blocking</td></tr>
<tr><td><strong>goroutine</strong></td><td>Go-‡¶è‡¶∞ ultra-light thread ‚Äî request handle ‡¶ï‡¶∞‡ßá</td></tr>
</tbody></table>
</div>
<p>[<strong>Author:</strong> @nazma98
<strong>Date:</strong> 2025-07-30
<strong>Category:</strong> interview-qa/class-wise
]</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../interview-qna/class-wise/golang043-into-the-backend-development/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../interview-qna/topic-wise/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../interview-qna/class-wise/golang043-into-the-backend-development/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../interview-qna/topic-wise/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
